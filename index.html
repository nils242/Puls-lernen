<!DOCTYPE html>
<html>
  <head>
    <title>My App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="app.min.css">
  </head>

  <body>
    <div class="app-page" data-page="home">
      <div class="app-topbar" bgcolor="white">
        <div class="app-title">Pulsmessung üben</div>
      </div>
      <div class="app-content">
        <div class="app-section" style="color:darkgrey;">
          <div class="app-button green" id="startbutton" style="color:black;">Start</div></div>
        <div class="app-section" style="color:darkgrey;">
          <div class="app-button red" id="stopbutton" style="color:black;">Stop</div></div>
<div class="app-section">	      
<div class="feld1" align="center">  </div>
<div class="feld2" align="center">  </div>
<div class="feld3" align="center">  </div>	
<div class="feld4" align="center">  </div></div>
<div class="app-section"><div align="center"><img src="schrift.png">www.nilswommelsdorf.de</div></div>

   <script src="zepto.js"></script>
    <script src="app.min.js"></script>
    <script>

App.controller('home', function (page) {
  // this runs whenever a 'home' page is loaded
  // 'page' is the HTML app-page element

function pulsfrequenz()
{
var pfmin = 45;
var pfmax = 110;
pf = Math.floor(Math.random() * (pfmax - pfmin + 1)) + pfmin;
if (pf >= 100){
   pfrequenz = "Tachykardie (> 100 1/min)";
}
else if (pf <= 60){
   pfrequenz = "Bradykardie (< 60 1/min)";
}
else if (pf > 60 && pf < 80){
   pfrequenz = "Normokardie (60 - 80 1/min)";
}
else {
   pfrequenz = "Erhöhter Puls (80 - 100 1/min)";
}
Number( pf )  
pattquot = Math.round((60000 - (60 * pf)) / pf);
alert('Pulsfrequenz: ' + pf + '! /n Das ist: ' + pfrequenz + '! ! /n Der Quotient: ' + pattquot + '!'); 
};

function pulspattern()
{
var pattmin = 1;
var pattmax = 6;
patt = Math.floor(Math.random() * (pattmax - pattmin + 1)) + pattmin;
if (patt == 1) {
prhythmus = "Extrasystole (ohne kompensatorische Pause)"
pascii = "|.....|.....|..&nodot;...|.....|"
pattquotb = Math.round((pattquot - 40) / 1.8);
pattquotc = Math.round((pattquot - 40) / 2.25);  
vibrpattern = [60, pattquot, 60, pattquot, 60, pattquot, 60, pattquotb, 40, pattquotc, 60, pattquot, 60, pattquot, 60, pattquot];
patternlength = 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquotb + 40 + pattquotc + 60 + pattquot + 60 + pattquot + 60 + pattquot
}
else if (patt == 2) {
prhythmus = "Extrasystole (mit kompensatorischer Pause)"
pascii = "|.....|.....|..&nodot;.........|"	
pattquotb = Math.round((pattquot - 40) / 1.8);
pattquotc = Math.round((pattquot - 40) / 2.25);
pattquotd = Math.round(pattquot + pattquotc);  
vibrpattern = [60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot, 60, pattquotb, 40, pattquotd, 60, pattquot];
patternlength = 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquotb + 40 + pattquotd + 60 + pattquot
}
else if (patt == 3) {
prhythmus = "Pulsus Bigeminus"
pascii = |.&nodot;....|.&nodot;....|.&nodot;....|.&nodot;....|	
pattquote = Math.round((pattquot - 40) / 4.5);
pattquotf = Math.round((pattquot - 40) / 1.2857142857142); 
vibrpattern = [60, pattquote, 40, pattquotf, 60, pattquote, 40, pattquotf, 60, pattquote, 40, pattquotf, 60, pattquote, 40, pattquotf];
patternlength = 60 + pattquote + 40 + pattquotf + 60 + pattquote + 40 + pattquotf + 60 + pattquote + 40 + pattquotf + 60 + pattquote + 40 + pattquotf
}
else if (patt == 4) {
prhythmus = "Arrhythmie"
pascii = "|..|.....|....|..|.......|....|.|"	
pattquotb = Math.round((pattquot - 40) / 1.8);
pattquotc = Math.round((pattquot - 40) / 2.25);
pattquotd = Math.round(pattquot + pattquotc); 	
pattquote = Math.round((pattquot - 40) / 4.5);
pattquotf = Math.round((pattquot - 40) / 1.2857142857142);  
vibrpattern = [60, pattquote, 40, pattquotf, 60, pattquot, 60, pattquot, 60, pattquotb, 40, pattquotd, 60, pattquot, 60, pattquotb, 40, pattquotc];     
patternlength = 60 + pattquote + 40 + pattquotf + 60 + pattquot + 60 + pattquot + 60 + pattquotb + 40 + pattquotd + 60 + pattquot + 60 + pattquotb + 40 + pattquotc
}
else {
prhythmus = "Ruhepuls (Sinusrhythmus)"
pascii = "|.....|.....|.....|.....|"	
vibrpattern = [60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot, 60, pattquot];
patternlength = 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot + 60 + pattquot
}    
alert('Pattern: ' + patt + '!/n Das ist: ' + prhythmus + '! Länge: ' + patternlength + '! Ascii: ' + pascii + ''); 
};
 

		function startVibrate(level) {
			navigator.vibrate(level);
		}

		var vibrateInterval;
		function startPeristentVibrate(level, interval) {
			vibrateInterval = setInterval(function() {
				startVibrate(level);
			}, interval);
		}
		
		function stopVibrate() {
			if(vibrateInterval) clearInterval(vibrateInterval);
			navigator.vibrate(0);
		}  		
	
  $(page)
    .find('#startbutton')
    .on('click', function () {
pulsfrequenz()
pulspattern()
startPeristentVibrate(vibrpattern, patternlength);
   $(page).find('.feld1').text(" ");
   $(page).find('.feld2').text(" ");
   $(page).find('.feld3').text(" ");
   $(page).find('.feld4').text(" ");	  
   });
  $(page)
    .find('#stopbutton')
    .on('click', function () {
stopVibrate();
alert('Pulsfrequenz: ' + pf + '! /n vibration stopped!'); 
   $(page).find('.feld1').text('Pulsfrequenz: ' + pf + ' 1/min').css('font-weight', 'bold');
   $(page).find('.feld2').text('' + pfrequenz + '');  
   $(page).find('.feld3').text('Pulsrhythmus: ' + prhythmus + '').css('font-weight', 'bold');
   $(page).find('.feld4').text('' + pascii + ' - Stimmt`s?');
   });
});
      try {
        App.restore();
      } catch (err) {
        App.load('home');
      }
    </script>
  </body>
</html>
