<!DOCTYPE html>
<html>
  <head>
    <title>My App</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
    <link rel="stylesheet" href="app.min.css">
    <style>
}    </style>
  </head>

  <body>
    <div class="app-page" data-page="home">
      <div class="app-topbar">
        <div class="app-title">Pulsmessung üben</div>
      </div>
      <div class="app-content">
        <div class="app-section">
          <div class="app-button" id="startbutton">Start</div></div>
        <div class="app-section">
          <div class="app-button" id="stopbutton">Stop</div></div>
<div class="feld1"></div>
<div><img src="schrift.png" alt="eine grafik"></div>
<div class="feld2"></div>
       
      </div>
    </div>

   <script src="zepto.js"></script>
    <script src="app.min.js"></script>
    <script>

App.controller('home', function (page) {
  // this runs whenever a 'home' page is loaded
  // 'page' is the HTML app-page element

function pulsfrequenz()
{
var pfmin = 45;
var pfmax = 130;
pf = Math.floor(Math.random() * (pfmax - pfmin + 1)) + pfmin;
if (pf >= 100){
   pfrequenz = "Tachykardie (> 100 1/min)";
}
else if (pf <= 60){
   pfrequenz = "Bradykardie (< 60 1/min)";
}
else if (pf > 60 && pf < 80){
   pfrequenz = "Normokardie (60 - 80 1/min)";
}
else {
   pfrequenz = "Erhöhter Puls (80 - 100 1/min)";
}
Number( pf )  
pattquot = Math.round((60000 - (60 * pf)) / pf);
alert('Pulsfrequenz: ' + pf + '! /n Das ist: ' + pfrequenz + '! ! /n Der Quotient: ' + pattquot + '!'); 
};

function pulspattern()
{
var pattmin = 1;
var pattmax = 7;
patt = Math.floor(Math.random() * (pattmax - pattmin + 1)) + pattmin;
if (patt == 1) {
prhythmus = "Extrasystole (ohne kompensatorische Pause)"
pattquotb = Math.round(pattquot - 40 / 1.8);
pattquotc = Math.round(pattquot - 40 / 2.25);  
vibrpattern = Array('60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquotb + ', 40, ' + pattquotc + ', 60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquot + '');
}
else if (patt == 2) {
prhythmus = "Extrasystole (mit kompensatorischer Pause)"
pattquotb = Math.round(pattquot - 40 / 1.8);
pattquotc = Math.round(pattquot - 40 / 2.25);
pattquotd = Math.round(pattquot + pattquotc);  
vibrpattern = Array('60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquot + ', 60, ' + pattquotb + ', 40, ' + pattquotd + ', 60, ' + pattquot + '');
}
else if (patt == 3) {
prhythmus = "Pulsus Bigeminus"
pattquote = Math.round(pattquot - 40 / 4.5);
pattquotf = Math.round(pattquot - 40 / 1.2857142857142); 
vibrpattern = Array('60, ' + pattquote + ', 40, ' + pattquotf + '');
}
else if (patt == 4) {
prhythmus = "Arrhythmie"
pattquotb = Math.round(pattquot - 40 / 1.8);
pattquotc = Math.round(pattquot - 40 / 2.25);
pattquote = Math.round(pattquot - 40 / 4.5);
pattquotf = Math.round(pattquot - 40 / 1.2857142857142);  
vibrpattern = Array('60, ' + pattquotb + ', 60, ' + pattquotf + ', 60, ' + pattquotc + ', 60, ' + pattquotc + ', 60, ' + pattquote + ', 60, ' + pattquotb + ', 60, ' + pattquotf + '');     
}
else {
prhythmus = "Ruhepuls (Sinusrhythmus)"
vibrpattern = Array('60, ' + pattquot + '');
  
}    
alert('Pattern: ' + patt + '!/n Das ist: ' + prhythmus + '!'); 
};
 

		function startVibrate(level) {
			navigator.vibrate([50, 100, 50, 100]);
			alert('Pattern ist: ' + vibrpattern + '!/n level ist:  ' + level + '/n Start Vibration!')
		}

		var vibrateInterval;
		function startPeristentVibrate(level, interval) {
						alert('Pattern ist: ' + vibrpattern + '!/n level ist:  ' + level + '/n Persistent Vibration!')
			vibrateInterval = setInterval(function() {
				startVibrate(level);
			}, interval);
		}
		
		function stopVibrate() {
			if(vibrateInterval) clearInterval(vibrateInterval);
			navigator.vibrate(0);
		}  		
	
  $(page)
    .find('#startbutton')
    .on('click', function () {
pulsfrequenz()
pulspattern()
startPeristentVibrate(vibrpattern, 10000);
    alert('Pulsfrequenz: ' + pf + '! /n Pattern: ' + vibrpattern + '! /n vibration fired!');
   $(page).find('.feld1').text("");
   $(page).find('.feld2').text(pf);

   });
  $(page)
    .find('#stopbutton')
    .on('click', function () {
stopVibrate();
alert('Pulsfrequenz: ' + pf + '! /n vibration stopped!'); 
   $(page).find('.feld1').text("Umdrehen");

   });
});
      try {
        App.restore();
      } catch (err) {
        App.load('home');
      }
    </script>
  </body>
</html>
